


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.12">
    
    
      
        <title>Scheduling - RocketMod Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4dd2dd8d.min.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.6a5ad368.min.css">
      
      
        
        
        <meta name="theme-color" content="#00bdd6">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="cyan" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scheduling" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="RocketMod Documentation" class="md-header-nav__button md-logo" aria-label="RocketMod Documentation">
      
  <img src="../../../images/rocket.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            RocketMod Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Scheduling
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/RocketMod/Rocket/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    RocketMod/Rocket
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="RocketMod Documentation" class="md-nav__button md-logo" aria-label="RocketMod Documentation">
      
  <img src="../../../images/rocket.svg" alt="logo">

    </a>
    RocketMod Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/RocketMod/Rocket/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    RocketMod/Rocket
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      User Guide
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="User Guide" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Installation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Installation" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        <span class="md-nav__icon md-icon"></span>
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../user-guide/installation/unturned3/" title="Unturned 3" class="md-nav__link">
      Unturned 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../user-guide/installation/eco.md" title="Eco" class="md-nav__link">
      Eco
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Configuration
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Configuration" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        <span class="md-nav__icon md-icon"></span>
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../user-guide/configuration/configurations/" title="Configurations" class="md-nav__link">
      Configurations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../user-guide/configuration/translations/" title="Translations" class="md-nav__link">
      Translations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../user-guide/configuration/permissions/" title="Permissions" class="md-nav__link">
      Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../user-guide/configuration/plugins/" title="Plugins" class="md-nav__link">
      Plugins
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Plugins
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Plugins" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        Plugins
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../user-guide/plugins/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../user-guide/support/" title="Support" class="md-nav__link">
      Support
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Development Guide
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Development Guide" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Development Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Getting Started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        <span class="md-nav__icon md-icon"></span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../making-your-first-plugin/" title="Making your first plugin" class="md-nav__link">
      Making your first plugin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../commands/" title="Commands" class="md-nav__link">
      Commands
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Misc
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Misc" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon"></span>
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/migration-guide/" title="Migration Guide" class="md-nav__link">
      Migration Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/services/" title="List of all Services" class="md-nav__link">
      List of all Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/events/" title="List of all Events" class="md-nav__link">
      List of all Events
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      About
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="About" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/documentation/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
    <nav class="md-nav" aria-label="Getting Started">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scheduleeveryframe" class="md-nav__link">
    ScheduleEveryFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedulenextframe" class="md-nav__link">
    ScheduleNextFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduleeveryphysicupdate" class="md-nav__link">
    ScheduleEveryPhysicUpdate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedulenextphysicsupdate" class="md-nav__link">
    ScheduleNextPhysicsUpdate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduleeveryasyncframe" class="md-nav__link">
    ScheduleEveryAsyncFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schedulenextasyncframe" class="md-nav__link">
    ScheduleNextAsyncFrame
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduledelayed" class="md-nav__link">
    ScheduleDelayed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduleat" class="md-nav__link">
    ScheduleAt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scheduleperiodically" class="md-nav__link">
    SchedulePeriodically
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runonmainthread" class="md-nav__link">
    RunOnMainThread
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extra" class="md-nav__link">
    Extra
  </a>
  
    <nav class="md-nav" aria-label="Extra">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#getting-a-list-of-active-tasks" class="md-nav__link">
    Getting a List of Active Tasks
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cancelling-a-task" class="md-nav__link">
    Cancelling a Task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passing-arguments-to-tasks-when-scheduling" class="md-nav__link">
    Passing Arguments to Tasks when Scheduling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returning-data-with-callbacks" class="md-nav__link">
    Returning Data with Callbacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    Best Practices
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/RestoreMonarchyCommunity/Rocket.Documentation/edit/master/content/development-guide/getting-started/scheduling.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="scheduling">Scheduling<a class="headerlink" href="#scheduling" title="Permanent link">&para;</a></h1>
<p>RocketMod 5 includes a <code>ITaskScheduler</code> interface which allows to control tasks in a consistent way.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>With the TaskScheduler you can schedule a task to be run on:</p>
<ol>
<li>
<p>frame updates (same as Update in Unity).</p>
</li>
<li>
<p>physics updates (same as FixedUpdate in Unity).</p>
</li>
<li>
<p>seperate thread frame updates.</p>
</li>
</ol>
<p>Tasks are automatically destroyed on reloads and must be registered again in your plugins <code>OnActivate()</code> method.</p>
<h2 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p>To start you first need to pass the ITaskScheduler through the constructor of your plugin.
<div class="highlight"><pre><span></span><code><span class="k">using</span> <span class="nn">Rocket.API.DependencyInjection</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Rocket.API.Scheduler</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Rocket.Core.Plugins</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">SamplePlugin</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SamplePlugin</span> <span class="p">:</span> <span class="n">Plugin</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">ITaskScheduler</span> <span class="n">taskScheduler</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">SamplePlugin</span><span class="p">(</span><span class="n">IDependencyContainer</span> <span class="n">container</span><span class="p">,</span> <span class="n">ITaskScheduler</span> <span class="n">taskScheduler</span><span class="p">):</span> <span class="k">base</span><span class="p">(</span><span class="s">&quot;Sample Plugin&quot;</span><span class="p">,</span> <span class="n">container</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">taskScheduler</span> <span class="p">=</span> <span class="n">taskScheduler</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Once you have done that, you can begin to schedule your tasks.</p>
<h3 id="scheduleeveryframe">ScheduleEveryFrame<a class="headerlink" href="#scheduleeveryframe" title="Permanent link">&para;</a></h3>
<p>Schedules a task to run on every frame update.</p>
<div class="highlight"><pre><span></span><code><span class="k">protected</span> <span class="k">override</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">OnActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isFromReload</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// The &quot;My custom Task&quot; parameter is the description for your task. It</span>
    <span class="c1">// should be something that can identify your plugin and the exact task. </span>
    <span class="c1">// It will be shown to the user if an error occurs or when the user manages</span>
    <span class="c1">// tasks manually.</span>
    <span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleEveryFrame</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">void</span> <span class="nf">SampleTask</span> <span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Do something...</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="schedulenextframe">ScheduleNextFrame<a class="headerlink" href="#schedulenextframe" title="Permanent link">&para;</a></h3>
<p>Schedules a task to run on the next frame update and will run only once. This is useful if you need to access Game or Engine APIs which are not thread safe.</p>
<div class="highlight"><pre><span></span><code><span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleNextFrame</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">);</span>
</code></pre></div>

<h3 id="scheduleeveryphysicupdate">ScheduleEveryPhysicUpdate<a class="headerlink" href="#scheduleeveryphysicupdate" title="Permanent link">&para;</a></h3>
<p>Schedules a task to run on every physics update frame. 
<div class="highlight"><pre><span></span><code><span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleEveryPhysicUpdate</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">);</span>
</code></pre></div></p>
<blockquote>
<p><strong>Note</strong>: Physics update frame definition depends on the engine and game used. For Unity, it is the equivalent of "FixedUpdate". You should use Physic Update when you want to apply physics, e.g. when applying force to an object.  </p>
</blockquote>
<h3 id="schedulenextphysicsupdate">ScheduleNextPhysicsUpdate<a class="headerlink" href="#schedulenextphysicsupdate" title="Permanent link">&para;</a></h3>
<p>Schedules a task to run on the next physics update frame and will run only once.
<div class="highlight"><pre><span></span><code><span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleNextPhysicUpdate</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">);</span>
</code></pre></div></p>
<blockquote>
<p><strong>Note</strong>: Physics update frame definition depends on the engine and game used. For Unity, it is the equivalent of "FixedUpdate". You should use Physic Update when you want to apply physics, e.g. when applying force to an object.</p>
</blockquote>
<h3 id="scheduleeveryasyncframe">ScheduleEveryAsyncFrame<a class="headerlink" href="#scheduleeveryasyncframe" title="Permanent link">&para;</a></h3>
<p>Schedules a task to run on every frame on a <strong>seperate</strong> thread. Running on async frames is vital for performance if your task is doing heavy calculations and causing delays. This will prevent the server from freezing in such cases.
<div class="highlight"><pre><span></span><code><span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleEveryAsyncFrame</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">);</span>
</code></pre></div></p>
<blockquote>
<p><strong>Note</strong>: Keep in mind that in most cases you can not access Game or Engine APIs from separate threads.</p>
</blockquote>
<h3 id="schedulenextasyncframe">ScheduleNextAsyncFrame<a class="headerlink" href="#schedulenextasyncframe" title="Permanent link">&para;</a></h3>
<p>Schedules a task to be run on the next frame in a <strong>seperate</strong> thread once. Running on async frames is vital for performance if your task is doing heavy calculations and causing delays. This will prevent the server from freezing in such cases.</p>
<div class="highlight"><pre><span></span><code><span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleNextAsyncFrame</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">);</span>
</code></pre></div>

<blockquote>
<p><strong>Note</strong>: Keep in mind that in most cases you can not access Game or Engine APIs from separate threads.</p>
</blockquote>
<h3 id="scheduledelayed">ScheduleDelayed<a class="headerlink" href="#scheduledelayed" title="Permanent link">&para;</a></h3>
<p>Schedules a task to be run once after a set delay time. Can be configured to run the main thread or on a seperate thread.
<div class="highlight"><pre><span></span><code><span class="n">TimeSpan</span> <span class="n">runAfter</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromSeconds</span> <span class="p">(</span><span class="m">15</span><span class="p">);</span> <span class="c1">// Run after 15 seconds</span>
<span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleDelayed</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">,</span> <span class="n">runAfter</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span> <span class="c1">// Async, runs on separate thread</span>
<span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleDelayed</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">,</span> <span class="n">runAfter</span><span class="p">);</span> <span class="c1">// Sync, runs on main thread</span>
</code></pre></div></p>
<h3 id="scheduleat">ScheduleAt<a class="headerlink" href="#scheduleat" title="Permanent link">&para;</a></h3>
<p>Schedules a task to be run at the given time. The time is based on Utc timezone. Keep in mind that the execution time is not exact, but within a few milliseconds depending on the server load. 
<div class="highlight"><pre><span></span><code><span class="c1">// Run after 15 seconds</span>
<span class="n">DateTime</span> <span class="n">runTime</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">+</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromSeconds</span> <span class="p">(</span><span class="m">15</span><span class="p">);</span>

<span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleAt</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">,</span> <span class="n">runTime</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span> <span class="c1">// Async, runs on separate thread</span>
<span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleAt</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">,</span> <span class="n">runTime</span><span class="p">);</span> <span class="c1">// Sync, runs on main thread</span>
</code></pre></div></p>
<h3 id="scheduleperiodically">SchedulePeriodically<a class="headerlink" href="#scheduleperiodically" title="Permanent link">&para;</a></h3>
<p>Schedules a task to be run every set amount of time and with an optional first delay. Can be configured to run on <strong>main</strong> thread or a <strong>seperate</strong> thread.
<div class="highlight"><pre><span></span><code><span class="n">TimeSpan</span> <span class="n">runEvery</span> <span class="p">=</span> <span class="n">TimeSpan</span><span class="p">.</span><span class="n">FromSeconds</span><span class="p">(</span><span class="m">30</span><span class="p">);</span> <span class="c1">// Run every 30 seconds</span>
<span class="n">TimeSpan</span> <span class="n">runAfter</span> <span class="p">=</span> <span class="n">TuneSpan</span><span class="p">.</span><span class="n">FromSecond</span> <span class="p">(</span><span class="m">5</span><span class="p">);</span>  <span class="c1">// After a first 5 seconds delay</span>

<span class="n">taskScheduler</span><span class="p">.</span><span class="n">SchedulePeriodically</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">,</span> <span class="n">runEvery</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span> <span class="c1">// Async, runs on a separate thread</span>
<span class="n">taskScheduler</span><span class="p">.</span><span class="n">SchedulePeriodically</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">,</span> <span class="n">runEvery</span><span class="p">,</span> <span class="n">runAfter</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span> <span class="c1">// Delayed async</span>
<span class="n">taskScheduler</span><span class="p">.</span><span class="n">SchedulePeriodically</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">,</span> <span class="n">runEvery</span><span class="p">);</span> <span class="c1">// Sync, runs on main threasd</span>
<span class="n">taskScheduler</span><span class="p">.</span><span class="n">SchedulePeriodically</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">,</span> <span class="n">runEvery</span><span class="p">,</span> <span class="n">runAfter</span><span class="p">);</span> <span class="c1">// Delayed sync</span>
</code></pre></div></p>
<h3 id="runonmainthread">RunOnMainThread<a class="headerlink" href="#runonmainthread" title="Permanent link">&para;</a></h3>
<p>Schedules a task via <code>ScheduleNextFrame</code> if the current thread is no the main thread. Otherwise, it will run the task directly.</p>
<div class="highlight"><pre><span></span><code><span class="n">taskScheduler</span><span class="p">.</span><span class="n">RunOnMainThread</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My custom Task&quot;</span><span class="p">);</span>
</code></pre></div>

<h2 id="extra">Extra<a class="headerlink" href="#extra" title="Permanent link">&para;</a></h2>
<h3 id="getting-a-list-of-active-tasks">Getting a List of Active Tasks<a class="headerlink" href="#getting-a-list-of-active-tasks" title="Permanent link">&para;</a></h3>
<p>This will return all scheduled tasks.
<div class="highlight"><pre><span></span><code><span class="kt">var</span> <span class="n">pendingTasks</span> <span class="p">=</span> <span class="n">taskScheduler</span><span class="p">.</span><span class="n">Tasks</span><span class="p">;</span>
</code></pre></div></p>
<h3 id="cancelling-a-task">Cancelling a Task<a class="headerlink" href="#cancelling-a-task" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">ITask</span> <span class="n">myTask</span> <span class="p">=</span> <span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleEveryFrame</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">SampleTask</span><span class="p">,</span> <span class="s">&quot;My Task Description&quot;</span><span class="p">);</span>
<span class="n">myTask</span><span class="p">.</span><span class="n">Cancel</span><span class="p">();</span>
</code></pre></div>

<h3 id="passing-arguments-to-tasks-when-scheduling">Passing Arguments to Tasks when Scheduling<a class="headerlink" href="#passing-arguments-to-tasks-when-scheduling" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">protected</span> <span class="k">override</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">OnActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isFromReload</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">string</span> <span class="n">myArgument</span> <span class="p">=</span> <span class="s">&quot;A little touch of wizard&quot;</span><span class="p">;</span>

    <span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleNextFrame</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">SampleTask</span><span class="p">(</span><span class="n">myArgument</span><span class="p">),</span> <span class="s">&quot;Wizard&#39;s Sample Task&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">void</span> <span class="nf">SampleTask</span> <span class="p">(</span><span class="kt">string</span> <span class="n">sampleParameter</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Logger</span><span class="p">.</span><span class="n">LogInformation</span><span class="p">(</span><span class="n">sampleParameter</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="returning-data-with-callbacks">Returning Data with Callbacks<a class="headerlink" href="#returning-data-with-callbacks" title="Permanent link">&para;</a></h3>
<p>You can't not return directly from tasks, however you can create a callback.
<div class="highlight"><pre><span></span><code><span class="k">protected</span> <span class="k">override</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">OnActivate</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isFromReload</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">taskScheduler</span><span class="p">.</span><span class="n">ScheduleNextAsyncFrame</span> <span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">SampleTask</span><span class="p">(</span><span class="n">SampleTaskCallback</span><span class="p">),</span> <span class="s">&quot;SampleMethod&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">void</span> <span class="nf">SampleTask</span><span class="p">(</span><span class="n">Action</span><span class="p">&lt;</span><span class="n">MyObject</span><span class="p">&gt;</span> <span class="n">callback</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">MyObject</span> <span class="n">sampleData</span> <span class="p">=</span> <span class="c1">// Do Something...</span>

    <span class="c1">// Run callback on same thread:</span>
    <span class="n">callback</span><span class="p">?.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">sampleData</span><span class="p">);</span>

    <span class="c1">// Run callback on main thread:</span>
    <span class="k">if</span><span class="p">(</span><span class="n">callback</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span> 
        <span class="n">taskScheduler</span><span class="p">.</span><span class="n">RunOnMainThread</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">callback</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">sampleData</span><span class="p">),</span> <span class="s">&quot;My Callback&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">void</span> <span class="nf">SampleTaskCallback</span> <span class="p">(</span><span class="n">MyObject</span> <span class="n">sampleReturn</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Do some more things...</span>
<span class="p">}</span>
</code></pre></div></p>
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<p>Always use the TaskScheduler if you need to run tasks in a separate thread. The TaskScheduler provides RocketMod a uniform way to handle tasks in a consistent way. For example, this way RocketMod can dynamically schedule and run tasks based on current server load.</p>
<p>In order to achieve this,</p>
<ul>
<li>
<p><strong>Don't create your own threads.</strong></p>
</li>
<li>
<p><strong>Don't use the Timer class for running tasks periodically.</strong></p>
</li>
<li>
<p><strong>Do not use engine specific components like MonoBehaviour's for functions like Update(), FixedUpdate(), etc.</strong></p>
</li>
</ul>
<p>Use the TaskScheduler instead.</p>
<p>Because RocketMod can not control custom plugin threads, this would result in lots of threads with no pooling. As a result, a lot of context switches would occur which would drastically slow down performance. Plugins also often do not create and handle threads correctly, resulting in endless loops and poor performance.</p>
<p>RocketMod uses <code>WaitHandle</code>s to ensure that threads do not run in empty loops and also dynamically schedules tasks to always ensure best performance.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            RocketMod is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a><br>This documentation is licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a>
          </div>
        
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.3636a4ec.min.js"></script>
      <script src="../../../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>